Вычисляем частоты пикселей, сортируем по возрастанию значений пикселей 
и функцию = сумма до i-го пикселя(частота встречаемости пикселя*значение пикселя)/сумма до i-го пикселя(часота встречаемости). 
Апроксимируем функцию полиномом 15 степени
Находим точки перегиба (по второй производной функции - она равна нулю в этой точке и меняет знак при переходе через неё)
Точки перегиба по иксу - это значение пикселей - это значение для порога
Применяем на изображении все найденные пороги и сравниваем результат - смотрим на медианную площадь
Тот порог, при котором медианная площадь максимальна, оптимальный
